---
title: 2024-05-01 バウンスメールの対応
categories: mail
---

バウンスメールにについてChatGPTにまとめてもらったのでメモ。

## ハードバウンス vs ソフトバウンス

まずはハードバウンスとソフトバウンスの違いについて。

| 特徴             | ハードバウンス                                                                     | ソフトバウンス                                                                           |
| ---------------- | ---------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------- |
| **定義**         | メールが永久的な理由で配信できなかった状態。                                       | メールが一時的な問題により配信できなかった状態。                                         |
| **原因**         | - 宛先メールアドレスが存在しない<br>- ドメインが無効<br>- 受信者サーバーによる拒否 | - メールボックスが満杯<br>- サーバーが一時的に利用不可能<br>- メールのサイズが大きすぎる |
| **処理**         | 通常、送信リストから削除することが推奨される。                                     | 問題が解決した後、メールを再送信することができる場合がある。                             |
| **通知メール**   | エラーメッセージが明確で、配信不可能を示す。                                       | エラーメッセージが一時的な問題を示唆し、しばしば再試行が可能。                           |
| **再試行の可否** | 再試行は推奨されない。                                                             | 状況によっては再試行が有効な場合がある。                                                 |

## バウンス処理の実装について

ChatGPT says:

> メールサーバーにおけるバウンス処理の実装は、通常、メールの配信失敗を検知し、適切なフィードバックを送信者に提供するためのシステムです。実装の詳細は使用するメールサーバーソフトウェアによって異なりますが、一般的なプロセスは以下の通りです：
>
> ### 1. 配信失敗の検出
>
> - メールサーバーが受信者サーバーにメールを送信するとき、SMTPプロトコルを使用して通信します。受信サーバーがメールを受け入れられない場合（例えば、受信者アドレスが存在しない、サーバーが一時的に利用不可能、メールボックスが満杯等）、エラーコードと共に応答が返されます。
>
> ### 2. エラーコードの解析
>
> - 受け取ったエラーコードに基づき、メールサーバーはそれがハードバウンスかソフトバウンスかを判断します。例えば、"550 5.1.1 User unknown" のようなエラーはハードバウンスを示し、"451 4.4.2 Timeout" のようなエラーはソフトバウンスを示すことが多いです。
>
> ### 3. バウンスメールの生成
>
> - バウンスが確認された場合、サーバーは自動的にバウンスメールを生成します。このメールには、元の送信者に対する通知として、バウンスの理由や詳細が含まれます。通常、バウンスメールにはオリジナルのメールヘッダが含まれることが多く、問題の診断に役立ちます。
>
> ### 4. バウンスメールの送信
>
> - 生成されたバウンスメールは、オリジナルの送信者に戻されます。これにより、送信者はメールが配信されなかった理由を知ることができ、必要に応じて対応を行うことができます。
>
> ### 5. ログと監視
>
> - メールサーバーは通常、送受信された全てのメールのログを保持しています。バウンスが発生した場合、これは詳細なログに記録され、サーバー管理者がトラブルシューティングや監視のために使用することができます。
>
> ### 注意点
>
> - バウンス処理を正しく管理するためには、サーバーの設定を適切に行い、送信ポリシーを適切に設定することが重要です。例えば、大量のメールを送信する際には、送信リストを定期的にクリーニングして、不正確なメールアドレスを削除することが推奨されます。
>
> これらのステップにより、メールサーバーはバウンスを効率的に処理し、メールシステムの健全性を維持するのに役立ちます。
