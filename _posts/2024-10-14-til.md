---
title: 2024-10-14 Ruby endless method
categories: ruby
last_modified_at: 2025-12-28
---

Ruby 3.0 からendless methodが導入された。

```ruby
def raise_to_power(number, power) = number ** power

puts raise_to_power(2, 3) #=> 8
```

ref. [Ruby 3 adds endless method definition - BigBinary Blog](https://www.bigbinary.com/blog/ruby-3-adds-endless-method-definition)

## 便利なユースケース

endless method + `Data.define` を使った例。
 
```rb
# Ruby 3

class Vec < Data.define(:x, :y, :z)
  def +(v) = Vec[x + v.x, y + v.y, z + v.z]
  def -(v) = Vec[x - v.x, y - v.y, z - v.z]

  def *(c) = Vec[x * c, y * c, z * c]
  def /(c) = Vec[x / c, y / c, z / c]

  def dot(v) = x * v.x + y * v.y + z * v.z
  def cross(v) = Vec[y * v.z - z * v.y, z * v.x - x * v.z, x * v.y - y * v.x]
end
```

使ってみる。

```rb
> v1 = Vec.new(2,3,4)
=> #<data Vec x=2, y=3, z=4>
> v2 = Vec.new(5,6,7)
=> #<data Vec x=5, y=6, z=7>
> v1 + v1
=> #<data Vec x=4, y=6, z=8>
> v1 + v2
=> #<data Vec x=7, y=9, z=11>
> v1 - v2
=> #<data Vec x=-3, y=-3, z=-3>
> v2 - v1
=> #<data Vec x=3, y=3, z=3>
```

### 元ネタ

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">Ruby 3.0のendless method definition、必要性がよくわかってなかったけど、ベクトルのクラス書くのに使ってみたら最高だった <a href="https://t.co/oNeu5ras6z">pic.twitter.com/oNeu5ras6z</a></p>&mdash; Yusuke Endoh (@mametter) <a href="https://twitter.com/mametter/status/1367639310342615040?ref_src=twsrc%5Etfw">March 5, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
