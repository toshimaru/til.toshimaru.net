---
title: 2023-03-12 RSA暗号と前方秘匿性
categories: security
---

下記のTweetについて考えていた。

ポイントは前方匿名性。

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">「対称鍵を公開鍵暗号で暗号化して共有」してしまっては確保されない特性とは何か？　って資格試験で出題すればよいのでは？ <a href="https://t.co/sM8yWri7No">https://t.co/sM8yWri7No</a></p>&mdash; Kazuho Oku (@kazuho) <a href="https://twitter.com/kazuho/status/1633737012292517889?ref_src=twsrc%5Etfw">March 9, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

## RSA暗号

ChatGPTに聞いてみた。

> RSA暗号とは、公開鍵暗号の一種であり、秘密鍵と公開鍵を使用してデータを暗号化および復号化することができる暗号アルゴリズムです。RSAは、Rivest, Shamir, Adlemanの3人の名前にちなんで名付けられました。
>
> RSA暗号では、公開鍵と秘密鍵の2つの鍵を使用してデータを暗号化および復号化します。公開鍵は、誰でも使用することができる鍵であり、秘密鍵は、所有者しか知らない鍵です。データを暗号化するときには、公開鍵を使用して暗号化し、復号するときには、秘密鍵を使用して復号します。
>
> RSA暗号のセキュリティは、大きな素数を素因数分解することが困難であることに基づいています。RSA暗号では、公開鍵と秘密鍵の生成に素数が使われます。非常に大きな素数を使用することで、暗号を解読することが非常に困難になります。
>
> RSA暗号は、オンラインバンキングや電子メールなどのセキュアな通信に使用されています。しかし、量子コンピューターの発展によって、RSA暗号が破られる可能性があることが指摘されています。このため、より強力な暗号アルゴリズムの開発が求められています。

## 前方秘匿性（forward secrecy）

> 前述のように推奨される鍵交換の方法は、RSAから使い捨てDiffie Hellman系に変わりました。理由は、RSAが持たない前方秘匿性（forward secrecy）を使い捨てDiffie Hellman系が持つからです。前方秘匿性とは、将来に渡ってデータの秘匿性が守られることです。
>
> 鍵交換にRSAを用いると、前方秘匿性がない理由を考えましょう。クライアントがサーバにTLSで接続すると、サーバはクライアントに証明書を送ります。証明書とは、認証局の署名が付いたサーバの公開鍵のことです。クライアントは、サーバと共有すべき秘密を生成し、サーバのRSA公開鍵で暗号化してサーバに送ります。この暗号文を復号できるのは、RSA秘密鍵をもっているサーバのみです。これで、クライアントとサーバは秘密が共有できましたので、この秘密から生成される鍵を使い、共通鍵暗号で通信路を保護します。

> 一方、使い捨てDiffie Hellman系では、クライアントとサーバが、お互いに使い捨ての公開鍵と秘密鍵を生成します。これらの秘密鍵はディスクに保存されることはないので、前述のようなことは起こりません。

[3.技術トレンド \| Internet Infrastructure Review（IIR）Vol.31 \| IIJの技術 \| インターネットイニシアティブ(IIJ)](https://www.iij.ad.jp/dev/report/iir/031/03_03.html#:~:text=%E5%89%8D%E6%96%B9%E7%A7%98%E5%8C%BF%E6%80%A7%E3%81%A8%E3%81%AF,%E5%85%AC%E9%96%8B%E9%8D%B5%E3%81%AE%E3%81%93%E3%81%A8%E3%81%A7%E3%81%99%E3%80%82)

## RSA暗号と前方秘匿性

ChatGPT says:

> RSA暗号には前方秘匿性がありません。これは、RSA暗号において、秘密鍵が漏洩すると、これまでに送信された暗号化されたメッセージを解読できてしまうためです。つまり、秘密鍵が漏洩すると、それまでに送信されたすべてのメッセージが解読されてしまうため、前方秘匿性を持たないと言われています。
>
> 一方、前方秘匿性を持つ共通鍵暗号では、秘密鍵の漏洩によって過去に送信されたすべてのメッセージを解読されることはありません。これは、共通鍵が定期的に変更されるため、過去の共通鍵で暗号化されたメッセージを解読することができないためです。

## 楕円曲線ディフィー・ヘルマン鍵共有

> 楕円曲線ディフィー・ヘルマン鍵共有（だえんきょくせんディフィー・ヘルマンかぎきょうゆう、英: Elliptic curve Diffie–Hellman key exchange, ECDH）は、事前の秘密の共有無しに、盗聴の可能性のある通信路を使って、暗号鍵の共有を可能にする、公開鍵暗号方式の暗号プロトコルである。両者で共有した秘密の値はそのまま、あるいは何かしらの変換をかけて、共通鍵暗号の鍵として用いることができる。 ディフィー・ヘルマン鍵共有を楕円曲線を使うように変更した、楕円曲線暗号の一つである。

[楕円曲線ディフィー・ヘルマン鍵共有 - Wikipedia](https://ja.wikipedia.org/wiki/%E6%A5%95%E5%86%86%E6%9B%B2%E7%B7%9A%E3%83%87%E3%82%A3%E3%83%95%E3%82%A3%E3%83%BC%E3%83%BB%E3%83%98%E3%83%AB%E3%83%9E%E3%83%B3%E9%8D%B5%E5%85%B1%E6%9C%89#:~:text=%E6%A5%95%E5%86%86%E6%9B%B2%E7%B7%9A%E3%83%87%E3%82%A3%E3%83%95%E3%82%A3%E3%83%BC%E3%83%BB%E3%83%98%E3%83%AB%E3%83%9E%E3%83%B3%E9%8D%B5%E5%85%B1%E6%9C%89%EF%BC%88%E3%81%A0%E3%81%88%E3%82%93%E3%81%8D%E3%82%87%E3%81%8F%E3%81%9B%E3%82%93,%E3%81%AE%E6%9A%97%E5%8F%B7%E3%83%97%E3%83%AD%E3%83%88%E3%82%B3%E3%83%AB%E3%81%A7%E3%81%82%E3%82%8B%E3%80%82)
