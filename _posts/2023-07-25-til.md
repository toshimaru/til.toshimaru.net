---
title: 2023-07-25 MySQL 8.0 ã®default collationã¯utf8mb4_0900_ai_ci
categories: mysql
last_modified_at: 2023-07-30
---

MySQL 8.0 ã‹ã‚‰ default collation ãŒ `utf8mb4_0900_ai_ci` ã«ãªã£ãŸã€‚

> MySQL 8.0 changed the utf8mb4 default collation from `utf8mb4_general_ci` to `utf8mb4_0900_ai_ci` (for details, see [here](https://dev.mysql.com/blog-archive/mysql-8-0-collations-the-devil-is-in-the-details/) and [here](https://dev.mysql.com/blog-archive/new-collations-in-mysql-8-0-0/)).

ref. [An in depth DBA's guide to migrating a MySQL database from the `utf8` to the `utf8mb4` charset â€“ Saverio Miroddi â€“ 64K RAM SYSTEM Â 38911 BASIC BYTES FREE](https://saveriomiroddi.github.io/An-in-depth-dbas-guide-to-migrating-a-mysql-database-from-the-utf8-to-the-utf8mb4-charset/)

## Collations

### mysql 8 ã§è¿½åŠ ã•ã‚ŒãŸ collations

```
+----------------------------+
| Collation                  |
+----------------------------+
| utf8mb4_0900_ai_ci         |
| utf8mb4_de_pb_0900_ai_ci   |
| utf8mb4_is_0900_ai_ci      |
| utf8mb4_lv_0900_ai_ci      |
| utf8mb4_ro_0900_ai_ci      |
| utf8mb4_sl_0900_ai_ci      |
| utf8mb4_pl_0900_ai_ci      |
| utf8mb4_et_0900_ai_ci      |
| utf8mb4_es_0900_ai_ci      |
| utf8mb4_sv_0900_ai_ci      |
| utf8mb4_tr_0900_ai_ci      |
| utf8mb4_cs_0900_ai_ci      |
| utf8mb4_da_0900_ai_ci      |
| utf8mb4_lt_0900_ai_ci      |
| utf8mb4_sk_0900_ai_ci      |
| utf8mb4_es_trad_0900_ai_ci |
| utf8mb4_la_0900_ai_ci      |
| utf8mb4_eo_0900_ai_ci      |
| utf8mb4_hu_0900_ai_ci      |
| utf8mb4_hr_0900_ai_ci      |
| utf8mb4_vi_0900_ai_ci      |
+----------------------------+
```

> The convention used here is:
>
> - Character-set name (`utf8mb4`)
> - Language identifier (`de`,`is` etc)
> - Unicode version (`0900`)
> - Accent and case sensitivity (`ai_ci` means case and accent insensitive)

ref. [MySQL :: New collations in MySQL 8.0.0](https://dev.mysql.com/blog-archive/new-collations-in-mysql-8-0-0/)


### collation ã®æ¯”è¼ƒ

```
+------------+-----------------------+---------+-----------+
| Expression | Collation             | Result  | Comment   |
+------------+-----------------------+---------+-----------+
| 'Ã¥'='a'    | utf8mb4_0900_ai_ci    | True    | Correct   |
| 'â„«'='a'    | utf8mb4_0900_ai_ci    | True    | Correct   |
| 'â„«'='Ã¥'    | utf8mb4_0900_ai_ci    | True    | Correct   |
+------------+-----------------------+---------+-----------+
| 'Ã¥'='a'    | utf8mb4_da_0900_ai_ci | False   | Correct   |
| 'â„«'='a'    | utf8mb4_da_0900_ai_ci | False   | Correct   |
| 'â„«'='Ã¥'    | utf8mb4_da_0900_ai_ci | True    | Correct   |
+------------+-----------------------+---------+-----------+
| 'Ã¥'='a'    | utf8_general_ci       | True    | Correct   |
| 'â„«'='a'    | utf8_general_ci       | False   | Incorrect |
| 'â„«'='Ã¥'    | utf8_general_ci       | False   | Incorrect |
+------------+-----------------------+---------+-----------+
| 'Ã¥'='a'    | utf8_danish_ci        | False   | Correct   |
| 'â„«'='a'    | utf8_danish_ci        | True    | Incorrect |
| 'â„«'='Ã¥'    | utf8_danish_ci        | False   | Incorrect |
+------------+-----------------------+---------+-----------+
```

ref. [MySQL :: MySQL 8.0 Collations: The devil is in the details.](https://dev.mysql.com/blog-archive/mysql-8-0-collations-the-devil-is-in-the-details/)

å®Ÿéš›ã«è©¦ã—ã¦ã¿ã‚ˆã†ã€‚

```
mysql> SELECT 'â„«'='a' COLLATE utf8mb4_general_ci AS Result;
+--------+
| Result |
+--------+
|      0 |
+--------+
1 row in set (0.00 sec)

mysql> SELECT 'â„«'='a' COLLATE utf8mb4_0900_ai_ci AS Result;
+--------+
| Result |
+--------+
|      1 |
+--------+
1 row in set (0.01 sec)
```

## utf8mb4_0900_ai_ci is new default

`utf8mb4_0900_ai_ci`ãŒæ–°ã—ã„ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ãªã£ãŸã€‚

> MySQL 5.7 already provide a much newer `utf8mb4_unicode_520_ci` collation that handles characters in SMP correctly. The Sushi-Beer problem could be solved by switching to this collation. But in MySQL 8.0 we decided to take this a step further by introducing `utf8mb4_0900_ai_ci`, which is based on the latest Unicode standard, and we intend to set this collation as the default collation for utf8mb4.

[MySQL :: Sushi = Beer ?! An introduction of UTF8 support in MySQL 8.0](https://dev.mysql.com/blog-archive/sushi-beer-an-introduction-of-utf8-support-in-mysql-8-0/)

å®Ÿéš›ã«è©¦ã—ã¦ã¿ã‚‹ã¨ä¸‹è¨˜ã®é€šã‚Šã€‚

```
mysql> create database foo;
Query OK, 1 row affected (0.01 sec)

mysql> SELECT schema_name, default_collation_name FROM information_schema.SCHEMATA;
+--------------------+------------------------+
| SCHEMA_NAME        | DEFAULT_COLLATION_NAME |
+--------------------+------------------------+
| mysql              | utf8mb4_0900_ai_ci     |
| information_schema | utf8mb3_general_ci     |
| performance_schema | utf8mb4_0900_ai_ci     |
| sys                | utf8mb4_0900_ai_ci     |
| foo                | utf8mb4_0900_ai_ci     |
+--------------------+------------------------+
5 rows in set (0.00 sec)
```

## å‚è€ƒãƒªãƒ³ã‚¯

- [MySQL 8.0ã®Charset utf8mb4ã§ã®æ—¥æœ¬èªç’°å¢ƒã§ä½¿ã†Collationã§æ–‡å­—æ¯”è¼ƒã‚’ã—ã¦ã¿ã‚‹ - CLOVERğŸ€](https://kazuhira-r.hatenablog.com/entry/2021/05/08/232717)
