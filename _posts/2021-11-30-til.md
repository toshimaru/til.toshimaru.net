---
title: 2021-11-30 GitHub Actions の concurrency 制御
---

## GitHub Actions の concurrency 制御

`head_ref` にはブランチ名が入るので同じブランチ上で複数ジョブが走った場合に古いジョブをキャンセルすることができる。

```yaml
concurrency: 
  group: ${{ github.head_ref }}
  cancel-in-progress: true
```

[Workflow syntax for GitHub Actions - GitHub Docs](https://docs.github.com/en/actions/learn-github-actions/workflow-syntax-for-github-actions#example-using-concurrency-to-cancel-any-in-progress-job-or-run)

Private Repo の GitHub Actions で使用量を無駄に食いたくないときに設定しておくべきやつ。

### 調査してみた

`pull_request` や `pull_request_target` event でも下記の通り、ブランチ名が取得できることを確認した。

{% gist f14386ab69394e6ffb54aa799b9b124b %}
